{
    "Transform": "AWS::Serverless-2016-10-31",
    "Resources": {
        "PetTable": {
            "Type": "AWS::DynamoDB::Table",
            "Properties": {
                "TableName": "pet-table",
                "PointInTimeRecoverySpecification": {
                    "PointInTimeRecoveryEnabled": true
                },
                "SSESpecification": {
                    "KMSMasterKeyId" : "KMSDynamoKey",
                    "SSEEnabled" : true,
                    "SSEType" : "KMS"
                  },
                "AttributeDefinitions": [
                    {"AttributeName": "name", "AttributeType": "S"},
                    {"AttributeName": "sort-key", "AttributeType": "S"}
                ],
                "KeySchema": [
                    {"AttributeName": "name", "KeyType": "HASH"},
                    {"AttributeName":"sort-key", "KeyType": "RANGE"}
                ],
                "GlobalSecondaryIndexes": [
                    {
                        "IndexName": "medicine-name",
                        "KeySchema": [
                            {"AttributeName": "name", "KeyType": "HASH"},
                            {"AttributeName":"sort-key", "KeyType": "RANGE"}
                        ],
                        "Projection": {"ProjectionType": "ALL"}
                    },
                    {
                        "IndexName": "medicine-type",
                        "KeySchema": [
                            {"AttributeName": "name", "KeyType": "HASH"},
                            {"AttributeName":"sort-key", "KeyType": "RANGE"}
                        ],
                        "Projection": {"ProjectionType": "ALL"}
                    }
                ]
            }
        },
        "KMSDynamoKey":{
            "Type" : "AWS::KMS::Key",
            "Properties" : {
                "Description" : "For encryption on the DynamoDB table",
                "Enabled" : true,
                "EnableKeyRotation" : true,
                "KeySpec" : "SYMMETRIC_DEFAULT",
                "KeyUsage" : "ENCRYPT_DECRYPT",
                "MultiRegion" : false
              }
        }

    }
}